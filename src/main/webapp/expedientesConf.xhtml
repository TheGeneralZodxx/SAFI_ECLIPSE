<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:ace="http://www.icefaces.org/icefaces/components"
      xmlns:f="http://xmlns.jcp.org/jsf/core"> 
    <ui:composition template="./layout.xhtml">  
        <ui:define name="content">            
            <h:form id="formExpedientesConf" title=" " styleClass="form">
                <ace:panel id="ExpedientePanelActualizar" header="#{msg.confExpedientes}">  
                    <h:panelGrid columns="2" class="panel-buttons">
                        <h:panelGroup>                                               
                            <span class="fa fa-refresh" aria-hidden="true" style="margin-right: 5px;"/>
                            <ace:linkButton action="expedientesConf" actionListener="#{expedienteManagedBean.actualizar}" value="#{msg.confExpedientes}"/>                                                    
                        </h:panelGroup>
                    </h:panelGrid>
                    <ace:panel header="#{msg.busqueda}" collapsed="false"  toggleable="true" toggleSpeed="200" class="panel-buttons">                   
                        <table border="0" cellspacing="5" class="panel-buttons">                       
                            <tr>
                                <td align="right">
                                    <h:outputLabel value="#{msg.ejercicio}:" />
                                </td>
                                <td align="left">
                                    <ace:simpleSelectOneMenu id="slcEjercicio" value="#{expedienteManagedBean.idEjercicioBsq}" label="#{msg.ejercicio}">
                                        <f:selectItem  itemValue="0" noSelectionOption="true" itemLabel="ELEGIR"/>
                                        <f:selectItems value="#{expedienteManagedBean.selectItemsEjercicio}" />                                        
                                        <ace:ajax render="@all slcEjercicio slcSservicio slcCuentaBancaria" event="valueChange"/>
                                    </ace:simpleSelectOneMenu>
                                </td>                            
                            </tr>
                            <ui:fragment rendered="#{expedienteManagedBean.servicio==null}" >
                                <tr>
                                    <td align="right">
                                        <h:outputLabel value="#{msg.servicio}:" />
                                    </td>
                                    <td align="left">
                                        <ace:simpleSelectOneMenu id="slcSservicio" value="#{expedienteManagedBean.idServicioBsq}" label="#{msg.servicio}">
                                            <f:selectItem  itemValue="0" noSelectionOption="true" itemLabel="ELEGIR"/>
                                            <f:selectItems value="#{expedienteManagedBean.selectItemsServicio}" /> 
                                             <ace:ajax execute="@this" render="@all" event="blur" listener="#{expedienteManagedBean.actualizarServicioBsq()}" />
                                            <ace:ajax execute="@this" render="@all" event="valueChange" listener="#{expedienteManagedBean.actualizarServicioBsq()}"/>
                                        </ace:simpleSelectOneMenu>
                                    </td>                            
                                </tr> 
                            </ui:fragment>
                            <tr>
                                <td align="right">
                                    <h:outputLabel value="#{msg.cuentaBancaria}:" />
                                </td>
                                <td align="left">
                                    <ace:simpleSelectOneMenu id="slcCuentaBancaria" value="#{expedienteManagedBean.idCuentaBancariaBsq}" label="#{msg.cuentaBancaria}">
                                        <f:selectItem  itemValue="0" noSelectionOption="true" itemLabel="ELEGIR"/>
                                        <f:selectItems value="#{expedienteManagedBean.selectItemsCuentaBsq}"  />   
                                        <ace:ajax execute="@this" render="@all" event="blur" listener="#{expedienteManagedBean.actualizarServicioBsq()}" />
                                        <ace:ajax execute="@this" render="@all" event="valueChange"/>                                 
                                    </ace:simpleSelectOneMenu>
                                </td>                            
                            </tr>
                            <tr>
                                <td align="right">
                                    <h:outputLabel value="#{msg.codigoOrganismo}:"/>
                                </td>
                                <td align="left" colspan="3">
                                    <ace:simpleSelectOneMenu id="slcCodigoOrganismo" value="#{expedienteManagedBean.codigoOrganismoBsq}" label="#{msg.codigoOrganismo}">
                                        <f:selectItem  itemValue="0" noSelectionOption="true" itemLabel="ELEGIR"/>
                                        <f:selectItems value="#{expedienteManagedBean.selectItemsCodigoOrganismo}"  />   
                                        <ace:ajax />                                 
                                    </ace:simpleSelectOneMenu>
                                </td>
                            </tr>
                            <tr>
                                <td align="right">
                                    <h:outputLabel value="#{msg.correlativo}:"/>
                                </td>
                                <td align="left" colspan="3">
                                    <ace:simpleSelectOneMenu id="slcNumeroExp" value="#{expedienteManagedBean.numeroBuscar}" label="#{msg.correlativo}">
                                        <f:selectItem  itemValue="-1" noSelectionOption="true" itemLabel="ELEGIR"/>
                                        <f:selectItems value="#{expedienteManagedBean.selectItemsNumerosExpedientes}"  />   
                                        <ace:ajax render="@all" />                                 
                                    </ace:simpleSelectOneMenu>
                                </td>
                            </tr>                      
                            <tr>
                                <td align="right">
                                    <h:outputLabel value="#{msg.anio}:"/>
                                </td>
                                <td>
                                    <ace:textEntry value="#{expedienteManagedBean.anio}" required = "false"  style="width: 99%" maxlength="5" />
                                </td>                            
                            </tr>
                        </table>
                        <div align="right">
                            <h:panelGrid  columns="2">
                                <ace:pushButton value="#{msg.find}" style="margin-left:5px;" actionListener="#{expedienteManagedBean.buscar()}"/>
                                <ace:pushButton value="#{msg.actualizar}"  style="margin-left:5px;" actionListener="#{expedienteManagedBean.actualizar()}">                                        
                                    <ace:ajax render="@all"/>
                                </ace:pushButton>                                    
                            </h:panelGrid>
                        </div>
                        <ace:submitMonitor id="submitMonitorPage"
                                           for=":formExpedientesConf:ExpedientePanelActualizar"
                                           blockUI="@all"
                                           autoCenter="true"
                                           styleClass="submonitor"/>                                            
                    </ace:panel>                
                    <br/>                
                    <div align="right" class="panelBotonesBusqueda">                                            
                        <h:panelGrid cellpadding="5" cellspacing="5" columns="1" >                            
                            <h:outputText value="Se Encontraron #{expedienteManagedBean.listElementsExpedientes.size()} Expediente/s" style="font-size: 1.2em;font-weight: bold;" />                            
                        </h:panelGrid>
                    </div>
                    <ace:dataTable id="list" value="#{expedienteManagedBean.listElementsExpedientes}" var="item" rows="10" style="margin-top: 10px;" paginator="true" paginatorPosition="bottom">
                        <ace:column style="width: 10%; text-align: center" headerText="#{msg.codigo}">
                            <center>
                                <h:outputText value="#{item.codigo}"/>
                            </center>
                        </ace:column>
                        <ace:column style="width: 10%; text-align: center" headerText="#{msg.correlativo}">
                            <center>
                                <h:outputText value="#{item.numero}"/>
                            </center>
                        </ace:column>
                        <ace:column style="width: 10%; text-align: center" headerText="#{msg.anio}">
                            <center>
                                <h:outputText value="#{item.anio}"/>
                            </center>
                        </ace:column>     
                        <ace:column style="width: 10%; text-align: center" headerText="#{msg.cuenta}">
                            <center>
                                <h:outputText value="#{item.numeroCuenta} - #{item.descripcionCuenta}"/>
                            </center>
                        </ace:column> 
                        <ace:column id="accion" headerText="#{msg.action}" class="panelAcciones">
                            <h:panelGrid  columns="3">
                                <ace:pushButton id="detalle" action="detalleExpediente" actionListener="#{expedienteManagedBean.verDetalle}">
                                    <span class="fa fa-search-plus" aria-hidden="true"></span>
                                    <f:param name="codigo" value="#{item.codigo}"/>
                                    <f:param name="numero" value="#{item.numero}"/>
                                    <f:param name="anio" value="#{item.anio}"/>
                                    <f:param name="cuenta" value="#{item.numeroCuenta}"/>
                                </ace:pushButton>                           
                            </h:panelGrid>
                        </ace:column>  
                    </ace:dataTable>               
                </ace:panel>
            </h:form>         
        </ui:define>    
    </ui:composition> 
</html>